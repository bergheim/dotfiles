# defaults
# save syncstate in the Maildir directories itself
SyncState *
# only create local folders
Create Near
# by default (CopyArrivalDate no), if you copy an old email from inbox to
# Archive (e.g.) it will get the date of the copy assigned, instead of just
# keeping its original date of arrival! That doesn't sound like a very good
# default to me. Also see:
# https://rakhim.org/fastmail-setup-with-emacs-mu4e-and-mbsync-on-macos/
# https://wiki.archlinux.org/index.php/Isync#Emails_on_remote_server_have_the_wrong_date
CopyArrivalDate yes

Sync All # already global default

# NTNU account
# ----------------
IMAPAccount ntnu
    Host imap.alumni.ntnu.no
    Port 993
    UserCmd "pass show email/alumini/username"
    PassCmd "pass show email/alumini/pass"
    TLSType IMAPS

IMAPStore ntnu-remote
    Account ntnu

MaildirStore ntnu-local
    SubFolders Verbatim
    Path ~/.mail/ntnu/
    Inbox ~/.mail/ntnu/Inbox
    # Trash Trash
    # TODO trash?

Channel ntnu
    Far :ntnu-remote:
    Near :ntnu-local:
    Patterns *
    Expunge Both

Channel ntnu-inbox
    Far :ntnu-remote:
    Near :ntnu-local:
    Patterns "INBOX" "Sent" "Trash" "Drafts"
    Expunge Both

# mailbox.org account
# ----------------
IMAPAccount mailbox
    Host imap.mailbox.org
    UserCmd "pass show email/mailbox/address"
    PassCmd "pass show email/mailbox/pass"
    TLSType IMAPS

IMAPStore mailbox-remote
    Account mailbox

MaildirStore mailbox-local
    SubFolders Verbatim
    Path ~/.mail/mailbox/
    Inbox ~/.mail/mailbox/Inbox

Channel mailbox-spam
    Far :mailbox-remote:"Junk"
    Near :mailbox-local:"Spam"
    Expunge Both

Channel mailbox
    Far :mailbox-remote:
    Near :mailbox-local:
    Patterns * !"Junk" !"Spam"
    Expunge Both

Channel mailbox-inbox
    Far :mailbox-remote:
    Near :mailbox-local:
    Patterns "INBOX" "Sent" "Trash" "Drafts"
    Expunge Both

Group mailbox
    Channel mailbox
    Channel mailbox-spam

# gmail account
# --------------
IMAPAccount gmail
    Host imap.gmail.com
    UserCmd "pass show email/gmail/address"
    PassCmd "pass show email/gmail/mbsync"
    AuthMechs LOGIN
    TLSType IMAPS
    CertificateFile /etc/ssl/certs/ca-certificates.crt

IMAPStore gmail-remote
    Account gmail

MaildirStore gmail-local
    SubFolders Verbatim
    # Trailing / is important
    Path ~/.mail/gmail/
    Inbox ~/.mail/gmail/Inbox
    # Trash [Gmail].Trash
    Flatten .

Channel gmail-inbox
    Far :gmail-remote:
    Near :gmail-local:
    # Just sync things that operations on an email can affect
    Patterns "INBOX"
    Expunge Both

Channel gmail-archive
    Far :gmail-remote:"Archives"
    Near :gmail-local:"Archive"
    Expunge Both

Channel gmail-trash
    Far :gmail-remote:"[Gmail]/Trash"
    Near :gmail-local:"Trash"
    Expunge Both

Channel gmail-sent
    Far :gmail-remote:"[Gmail]/Sent Mail"
    Near :gmail-local:"Sent"
    Expunge Both

Channel gmail-drafts
    Far :gmail-remote:"[Gmail]/Drafts"
    Near :gmail-local:"Drafts"
    Expunge Both

Channel gmail-starred
    Far :gmail-remote:"[Gmail]/Starred"
    Near :gmail-local:"Starred"
    Expunge Both

Channel gmail-spam
    Far :gmail-remote:"[Gmail]/Spam"
    Near :gmail-local:"Spam"
    Expunge Both

Group gmail
    Channel gmail-inbox
    Channel gmail-archive
    Channel gmail-trash
    Channel gmail-sent
    Channel gmail-drafts
    Channel gmail-starred
    Channel gmail-spam

Group gmail-inbox
    Channel gmail-inbox
    Channel gmail-trash
    Channel gmail-sent
    Channel gmail-drafts
    Channel gmail-starred